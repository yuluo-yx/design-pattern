# 代理（委托）模式 （Proxy Design Pattern）

代理模式：由于某些原因需要给原始对象提供一个代理以控制对该对象的访问。这时，访问对象不适合或者不能直接引用目标对象，代理对象作为访问对象和目标对象之间的中介。

## 1. 应用

1. OpenFeign的动态代理；
2. Spring AOP，事务等；
3. 符合开闭原则，可以在代理类中对原始类增加功能扩展，而不用修改原始类。负责为委托类预处理消息、过滤消息、把消息转发给委托类，以及事后对返回结果的处理等。代理类本身并不真正实现原始类服务，而是同过调用委托类的相关方法，来提供特定的服务。例如日志记录，事务处理，缓存等。

### 1.1 优点

1. 代理模式在客户端与目标对象之间起到一个中介作用和保护目标对象的作用；
2. 代理对象可以扩展目标对象的功能；
3. 代理模式能将客户端与目标对象分离，在一定程度上降低了系统的耦合度。

### 1.2 缺点

1. 增加系统复杂度；
2. 逻辑处理路径变长，处理速度变慢。

## 2. 实现分析

代理模式有多种实现，常见的是静态和动态代理两种模式。
其中动态代理在 Java 中常见用 JDK 和 CGLIB 代理。

### 2.1 Java 

### 2.2 Go

## 3. 面试题

Q：OpenFeign 中怎么样使用了代理设计模式？
A：OpenFeign的动态代理实现原理是使用 Java 动态代理技术，通过创建代理对象拦截 OpenFeign 接口的方法调用，并将这些调用转发到一个 HTTP 客户端进行处理。

Q：Spring AOP 代理实现
A：Spring 提供了 JDK 和 CGLIB 两种代理方式，默认使用 JDK 的动态代理来实现 AOP。**但是遵循一个原则：如果加入容器的目标对象有实现接口,用 JDK 代理；如果目标对象没有实现接口,用 CGLIB 代理。**
 1. JDK 动态代理实现
 2. CGLIB 动态代理实现
